<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ViajesMX - Inicio Movil</title>
    <!-- link de css Boostrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <!-- Link css Propio -->
    <link rel="stylesheet" href="../assets/css/styles-movil-app.css">
    <!-- CSS para los icons de Boxicons
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'> -->
</head>

<body>

    <!-- SVG's Icons -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <symbol id="search" viewbox="0 0 16 16">
            <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
        </symbol>

        <symbol id="home" viewbox="0 0 16 16">
            <path
                d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z" />
        </symbol>

        <symbol id="home-active" viewbox="0 0 16 16">
            <path
                d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5Z" />
            <path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6Z" />
        </symbol>

        <symbol id="calendar" viewbox="0 0 16 16">
            <path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z" />
            <path
                d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
        </symbol>

        <symbol id="calendar-active" viewbox="0 0 16 16">
            <path
                d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4V.5zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2zm-3.5-7h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5z" />
        </symbol>

        <symbol id="contact" viewbox="0 0 16 16">
            <path
                d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
            <path
                d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z" />
        </symbol>

        <symbol id="contact-active" viewbox="0 0 16 16">
            <path
                d="M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM5 8a1 1 0 1 0-2 0 1 1 0 0 0 2 0zm4 0a1 1 0 1 0-2 0 1 1 0 0 0 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
        </symbol>
    </svg>

    <div class="contenedor-principal-mx">
        <div id="first-section-header" class="fixed-top">
            <div id="text-part">
                <h5>Hola, <span id="nombre-usuario"></span></h5>
                <h1> Encuentra Ofertas</h1>
            </div>

            <div id="icon-user-part" style="margin-top: 5px;">
                <div class="dropdown" style="margin-top: 5px;">
                    <a href="#" class="d-block link-body-emphasis text-decoration-none dropdown-toggle"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="../assets/images/users/user.jpg" alt="mdo" width="40" height="40"
                            class="rounded-circle">
                    </a>
                    <ul class="dropdown-menu text-small">
                        <li id="cerrar-session"><a class="dropdown-item" href="../index.html"> <i class='bx bxs-log-in'
                                    style='color:#ff0000'></i>
                                <span> <b>Cerrar sesion</b></span></a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="second-section-header" style="margin-top: 100px;">
            <div class="bar-search">
                <div class="input-group mb-6">
                    <button class="btn" type="button" id="button-addon14">Buscar</button>
                    <input type="search" class="form-control" placeholder="Â¿Cual sera tu proximo viaje?"
                        aria-label="Example text with button addon" aria-describedby="button-addon14" id="buscador1">
                </div>
            </div>
        </div>

        <!-- Seccion de Tarjetas -->

        <!-- Primera parte -->

        <div id="third-section-header" style="margin-top: -20px;">
            <h3>Destinos por descubrir <span class="badge bg-success">Nuevos</span></h3>
            <h4 style="font-size: 13px; color: rgba(128, 128, 128, 0.646);">Ver Todos</h4>
        </div>
        <div class="container" style="margin-top: -10px;">
            <div class="card-row" id="contenedor-destinosdescrubrir"></div>
        </div>

        <!-- Segunda parte -->
        <div id="third-section-header" style="margin-top: 25px">
            <h3>Lugares Magicos</h3>
            <h4 style="font-size: 13px; color: rgba(128, 128, 128, 0.646);">Ver Todos</h4>
        </div>
        <div class="container" style="margin-top: -10px;">
            <div class="card-row" id="segunda-seccion"></div>
        </div>

        <!-- Tercera parte -->
        <div id="third-section-header" style="margin-top: 20px">
            <h3>Te pueden interesar </h3>
            <h4 style="font-size: 13px; color: rgba(128, 128, 128, 0.646);">Ver Todos</h4>
        </div>
        <div class="container" style="margin-top: -10px;">
            <div class="card-row" id="tercera-seccion"></div>
        </div>

        <div id="separador" style="margin-top: 100px">
        </div>


        <!-- Barra de menu inferior de la App -->
        <nav class="fixed-bottom" id="nav-bottom">
            <center>
                <div id="icons-container">

                    <a href="../movile-version/home-movile-view.html">
                        <svg class="bi" width="30" height="30" style="fill: #046cdcae; margin-top: -20px;">
                            <use xlink:href="#home-active" />
                        </svg>
                    </a>

                    <a href="../movile-version/reservations-movil-view.html">
                        <svg class="bi" width="30" height="30" style="fill: #046cdcae; margin-top: -20px;">
                            <use xlink:href="#calendar" />
                        </svg>
                    </a>

                    <a href="../movile-version/contact-movile-view.html">
                        <svg class="bi" width="30" height="30" style="fill: #046cdcae; margin-top: -20px;">
                            <use xlink:href="#contact" />
                        </svg>
                    </a>

                </div>
            </center>
        </nav>
    </div>



    <!-- Scripts de Boostrap -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"
        integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS"
        crossorigin="anonymous"></script>

    <!-- script para las versiones -->
    <!-- <script src="../assets/js/version-vista.js"></script>
    <script src="../assets/js/functions-movil-min.js"></script> -->
    <script src="../app.js"></script>
    <!-- Script des sweetalert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    
    <script>
        if (!navigator.onLine) {
            Swal.fire({
                icon: "warning",
                title: "Offline",
                text: "Esta pagina no esta disponible en modo offline",
                confirmButtonText: "Mis reservaciones",
            }).then((result) => {
                if (result.isConfirmed) {
                    location.href = "../movile-version/reservations-movil-view.html";
                }
            });
        }

        window.addEventListener("offline", () => {
            Swal.fire({
                icon: "warning",
                title: "Offline",
                text: "Esta pagina no esta disponible en modo offline",
                confirmButtonText: "Mis reservaciones",
            }).then((result) => {
                if (result.isConfirmed) {
                    location.href = "../movile-version/reservations-movil-view.html";
                }
            });
        });
    </script>

    <!-- Modulo de FireBase -->
    <script type="module">
        //Script dado por el SDK de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        import { getFirestore, enableIndexedDbPersistence, collection, addDoc, doc, setDoc, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDt4o-uvGTqqwABAcNW8opH4iyA82B0blE",
            authDomain: "viajesmx-f07c8.firebaseapp.com",
            projectId: "viajesmx-f07c8",
            storageBucket: "viajesmx-f07c8.appspot.com",
            messagingSenderId: "437734415626",
            appId: "1:437734415626:web:821aaf367d26a5974aeef3"
        };

        const app = initializeApp(firebaseConfig);
        const firestore = getFirestore(app);

        //SCRIPT PROPIO******

        //Variables!
        const contenedor_pordescubrir = document.querySelector("#contenedor-destinosdescrubrir");
        const seccion_dos = document.querySelector("#segunda-seccion");
        const seccion_tres = document.querySelector("#tercera-seccion");

        //Funciones!

        //Crear las tarjetas de los sitios
        function crearTarjetaLugar(id_documento, imagen, nombre, ubicacion) {
            // Contenedor / link tarejta
            const link = document.createElement("a");
            link.href = "../movile-version/details-movile-view.html?id=" + id_documento;

            //Wrapper
            const tarjeta = document.createElement("div");
            tarjeta.classList.add("card");
            //Hijos de Wrapper
            //imagen
            const imagen1 = document.createElement("img");
            imagen1.src = "../assets/images/places/" + imagen;
            imagen1.alt = nombre;
            //Titulo
            const titulo = document.createElement("p");
            titulo.setAttribute("style", "font-weight: bold; font-size: 20px; margin-top: 10px;");
            titulo.textContent = nombre;
            //Subtitulo
            const subtitulo = document.createElement("p");
            subtitulo.setAttribute("style", "color: gray; font-size: 13px; margin-top: -15px;");
            subtitulo.textContent = ubicacion;

            //Adjuncion de los elementos
            link.appendChild(tarjeta);
            tarjeta.appendChild(imagen1);
            tarjeta.appendChild(titulo);
            tarjeta.appendChild(subtitulo);


            return link;
        }

        //Funcion para cargar Tarjetas
        function cargarTarjetasP() {
            const coleccionLugares = collection(firestore, 'lugares');
            const q = query(coleccionLugares, where('clasificacioninicio', '==', 'pordescrubrir'));

            getDocs(q)
                .then((querySnapshot) => {
                    querySnapshot.forEach((doc) => {

                        const data = doc.data(); //Se asigna la data que retorna la consulta a una variable

                        //Se asignan a variables los elementos especificos que se obtienen del data
                        let nombre = data.nombre;
                        let ubicacion = data.ubicacion;
                        let ruta = data.imagen;
                        let id = doc.id;

                        //Se crea la tarjeta
                        const tarjetaElemento = crearTarjetaLugar(id, ruta, nombre, ubicacion);
                        contenedor_pordescubrir.appendChild(tarjetaElemento);
                    });
                })
                .catch((error) => {
                    console.error('Error al realizar la consulta: ' + error);
                });
        }

        function cargarTarjetasS() {
            const coleccionLugares = collection(firestore, 'lugares');
            const q2 = query(coleccionLugares, where("clasificacioninicio", "==", "magicos"));

            getDocs(q2)
                .then((querySnapshot) => {
                    querySnapshot.forEach((doc1) => {

                        const data = doc1.data(); //Se asigna la data que retorna la consulta a una variable

                        //Se asignan a variables los elementos especificos que se obtienen del data
                        let nombre = data.nombre;
                        let ubicacion = data.ubicacion;
                        let ruta = data.imagen;
                        let id = doc1.id;

                        //Se crea la tarjeta
                        const tarjetaElemento1 = crearTarjetaLugar(id, ruta, nombre, ubicacion);
                        seccion_dos.appendChild(tarjetaElemento1);
                    });
                })
                .catch((error) => {
                    console.error('Error al realizar la consulta: ' + error);
                });
        }

        function cargarTarjetasT() {
            const coleccionLugares = collection(firestore, 'lugares');
            const q3 = query(coleccionLugares, where("clasificacioninicio", "==", "sugerencias"));

            getDocs(q3)
                .then((querySnapshot) => {
                    querySnapshot.forEach((doc5) => {

                        const data = doc5.data(); //Se asigna la data que retorna la consulta a una variable

                        //Se asignan a variables los elementos especificos que se obtienen del data
                        let nombre = data.nombre;
                        let ubicacion = data.ubicacion;
                        let ruta = data.imagen;
                        let id = doc5.id;

                        //Se crea la tarjeta
                        const tarjetaElemento3 = crearTarjetaLugar(id, ruta, nombre, ubicacion);
                        seccion_tres.appendChild(tarjetaElemento3);
                    });
                })
                .catch((error) => {
                    console.error('Error al realizar la consulta: ' + error);
                });
        }

        //Ejecucion principal

        cargarTarjetasP();
        cargarTarjetasS();
        cargarTarjetasT();
    </script>
</body>

</html>